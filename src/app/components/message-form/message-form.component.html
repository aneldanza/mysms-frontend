<form
  [formGroup]="form"
  (ngSubmit)="submit()"
  class="space-y-4 md:space-y-6 card"
>
  <h2 class="text-xl font-bold mb-4">New Message</h2>
  <div>
    <label class="label">To</label>
    <input
      formControlName="to"
      type="tel"
      placeholder="+1234567890"
      readonly
      class="input-field bg-gray-100"
    />
    <p
      *ngIf="form.get('to')?.invalid && form.get('to')?.touched"
      class="text-sm text-red-600 mt-1"
    >
      Valid phone number is required
    </p>
  </div>

  <div>
    <label class="label">Message</label>
    <textarea
      formControlName="body"
      rows="4"
      maxlength="250"
      (input)="onInputLimit($event)"
      (paste)="onPasteLimit($event)"
      placeholder="Type your message..."
      class="input-field"
    ></textarea>
    <p
      *ngIf="form.get('body')?.invalid && form.get('body')?.touched"
      class="text-sm text-red-600 mt-1"
    >
      Message is required (max 250 characters)
    </p>
    <div class="text-sm text-gray-500 justify-self-end">
      {{ form.get("body")?.value?.length || 0 }}/250
    </div>
    <div *ngIf="tooLong" class="text-red-600 text-sm mt-1">
      ⚠️ Message cannot exceed 250 characters.
    </div>
  </div>

  <div class="flex items-center justify-between">
    <button
      type="button"
      (click)="resetBodyField()"
      class="underline self-center cursor-pointer"
    >
      Clear
    </button>
    <button
      type="submit"
      [disabled]="form.invalid || loading"
      class="inline-flex items-center px-6 py-2 border border-transparent text-sm font-medium rounded-3xl shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"
    >
      <span *ngIf="!loading">Submit</span>
      <span *ngIf="loading" class="animate-pulse">Sending...</span>
    </button>
  </div>

  <p *ngIf="error" class="text-sm text-red-600">{{ error }}</p>
</form>
